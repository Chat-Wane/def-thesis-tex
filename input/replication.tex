\section{Structure de séquences répartie à large échelle}

\begin{frame}{Structure de séquences}{Réplication}
  \vspace{-1.5cm}
  La \textbf{réplication optimiste} \REF{} améliore la \textbf{disponibilité} d'un
  document et sa \textbf{réactivité} aux changements effectués.
  \vspace{0.75cm}

  Fonctionnement :
  \begin{enumerate}[(a)]
  \item Une modification produit un résultat;
  \item ce résultat est disséminé aux autres répliques;
  \item ces dernières exécutent -- ou intègrent -- le résultat reçu.
  \end{enumerate}

  \begin{textblock*}{\textwidth}(-0.65cm,0.4cm) 
    \input{img/figoptimisticsteps.tex}
  \end{textblock*}
\end{frame}


\begin{frame}{Structure de séquences}{Cohérence des répliques}
  
  \vspace{-1.5cm}

  D'après Sun et al. \REF{}, l'édition collaborative temps réel nécessite un
  système préservant les trois propriétés : 

  \begin{itemize}
  \item Convergence;
  \item Causalité;
  \item Intention.  
  \end{itemize}

  \begin{textblock*}{\textwidth}(-0.65cm,0.4cm) 
    \input{img/figcausality.tex}
  \end{textblock*}

\end{frame}


\begin{frame}{Structure de séquences}{Intention}
  
  L'effet observé sur le document lors de la génération d'une opération doit
  être également observé lors de son intégration malgré l'interférence
  d'opérations \textbf{concurrentes}.

  \vspace{0.5cm}

  \begin{itemize}
  \item Difficile à formaliser dans le cas général;
  \item L'opération doit respecter le plus possible sa spécification séquentielle \REF.
  \end{itemize}

  \vspace{0.5cm}
  
  Pour la séquence :
  \begin{itemize}
  \item \og insérer l'élément $e$ à la position $i$ dans la séquence \fg
  \item \og supprimer l'élément à la position $i$ dans la séquence \fg
  \end{itemize}

  \vspace{0.5cm}

  \begin{itemize}
    \only<1-1>{\item [$\rightarrow$]L'intention semble être liée à aux
      positions.}
    \only<2->{\item [$\rightarrow$]\sout{L'intention semble être
        liée aux \textbf{positions}.}}
    \uncover<2->{\item [$\rightarrow$] Une séquence
    se définit par un \textbf{ordre dense} sur ses éléments : les éléments 
    sont ordonnés
    et il est toujours possible d'insérer un élément entre deux autres éléments.}
  \end{itemize}
  
\end{frame}

\begin{frame}{Structure de séquences}{Spécification}
  \begin{definition}[Spécification séquentielle d'une séquence]
  Soit une série d'opérations $H$ produisant la séquence
  $s(H) = \{p_1,\, p_2 \ldots p_k\}$ avec $p_{1..k} \in \mathcal{P}$ où
  $\mathcal{P}$ est un ensemble muni d'un ordre
  dense $(\mathcal{P},\,<_\mathcal{P})$ tel que : \\
  $\forall p\in\mathcal{P},\, p_\vdash <_\mathcal{P} p <_\mathcal{P} p_\dashv $
  \hfill et \ \
  $p_\vdash <_\mathcal{P} p_1 <_\mathcal{P} p_2 <_\mathcal{P} \ldots
  <_\mathcal{P} p_k <_\mathcal{P} p_\dashv$.
  
  \vspace{0.25cm}

  \noindent L'insertion d'un élément $e$ en position $i$ dans la séquence $s(H)$
  est définie de la façon suivante :
  \begin{equation}
    \small
    s(H \cup INSERT(i,\, e)) \rightarrow s(H) \cup 
    \begin{cases}
      \{p,\, p_\vdash <_\mathcal{P} p <_\mathcal{P} p_\dashv \} & i = 0 \wedge |s(H)| = 0\\
      \{p,\, p_\vdash <_\mathcal{P} p <_\mathcal{P} p_1 \} & i = 0 \wedge |s(H)|>0\\
      \{p,\, p_k <_\mathcal{P} p <_\mathcal{P} p_\dashv \} & i = k\\
      \{p,\, p_i <_\mathcal{P} p <_\mathcal{P} p_{i+1} \} & sinon
    \end{cases}
  \end{equation}

  \noindent La suppression de l'élément en position $i$ dans la séquence $s(H)$
  est définie de la façon suivante :
  \begin{equation}
    \small
    s(H \cup DELETE(i)) \rightarrow s(H) \setminus \{ p_i \}
  \end{equation}
\end{definition}
\end{frame}


\begin{frame}{Structure de séquences}{Complexités}

\begin{itemize}
  \only<1-1>{\item Complexité en \textbf{communication};}
  \only<2->{\item  \textbf{Complexité en communication};}
\item Complexité \textbf{spatiale} de la réplique;
\item Complexité \textbf{temporelle} d'une opération \textbf{générée} localement;
  \only<1-1>{\item Complexité \textbf{temporelle} de l'\textbf{intégration} d'une opération reçue.}
  \only<2->{\item \textbf{Complexité temporelle de l'intégration d'une opération reçue.}}
\end{itemize}

%% (TODO) maybe explain the reasons of this emphasis
\end{frame}


% \begin{frame}{Structure de séquences}{État de l'art : transformées opérationnelles}

%   \vspace{-1.5cm}

%   Ces approches \REF{} ont une signature identique à celle communément employée
%   pour les séquences : 
%   \begin{itemize}
%   \item \textsc{insert}($element,\,position$)
%   \item \textsc{delete}($position$)
%   \end{itemize}

%   \vspace{0.5cm}

%   Lors de la réception d'une opération, ses arguments sont ajustés afin qu'ils
%   s'appliquent à l'état courant de la réplique malgré les opérations effectuées
%   et intégrées en concurrence. 


%   \begin{textblock*}{\textwidth}(-0.65cm,0.4cm) 
%     \input{img/figotexample.tex}
%   \end{textblock*}
% \end{frame}


\begin{frame}{Structure de séquences}{Le prix de la causalité}
  
  Ordonner les opérations selon l'ordre causal est extrêmement coûteux : au
  minimum $\mathcal{O}(W)$ en communication où $W$ est le nombre de participants
  ayant jamais écrit dans le document \REF.
  \begin{itemize}
  \item[$\rightarrow$] Relaxer l'ordre est nécessaire pour le passage à l'échelle
  \end{itemize}
  
  \vspace{0.5cm}
  
  \large
  \begin{itemize}
  \item [$\rightarrow$] L'utilisation de structures de données répliquées sans
    conflits \REF permet cela.
    \begin{itemize}
    \item [$\rightarrow$] Ces approches se basent sur la génération
      d'identifiants uniques et immuables. Nous nous intéresserons
      particulièrement à celles dont les identifiants sont des listes de taille
      variable.
    \end{itemize}
  \end{itemize}

\end{frame}

\begin{frame}{Structure de séquences}{Structures sans conflits}
  
  La signature change : 
  \begin{itemize}
  \item \textsc{insert}($element,\, position$) $\rightarrow$
    \textsc{insert}($id_{position-1},\, element,\, id_{position}$)
  \item \textsc{delete}($position$) $\rightarrow$ \textsc{delete}($id_{position}$)
  \end{itemize}

  \vspace{0.5cm}
  

  \begin{algorithm}[H]
    \input{img/algogeneral.tex}
  \end{algorithm}

\end{frame}


\begin{frame}{Structure de séquences}{Problèmes d'allocation}

  La fonction d'allocation ne connait ni le \textbf{nombre} de caractères, ni
  leur \textbf{position} dans la séquence finale.

  \vspace{0.5cm}

  \begin{center}
    \input{img/figendeditingexample.tex}
  \end{center}

\end{frame}


\begin{frame}{Structure de séquences}{Arbre}
  
  \begin{center}
    \input{img/figallocpathexampleB.tex}
  \end{center}
  
  \vspace{0.5cm}
  
  La taille des chemins impacte les performances de l'éditeur et le trafic
  généré par l'éditeur.
  \begin{itemize}
  \item [$\rightarrow$] \textsc{allocPath} doit allouer les plus petits chemins
    possibles.
  \end{itemize}

\end{frame}


\begin{frame}{Structure de séquences}{Définition du problème}

  \begin{problem}
    Soit la séquence d'identifiants $s(I)= id_1.id_2\ldots id_I$, et
    $s(I+1) = s(I) \cup $\textsc{insert}$(p,\, \_,\, n)$ où $p,q \in s(I)$ et
    $p<_\mathcal{I}q$. Soit $|s(I)|$ la taille de la représentation binaire de la
    séquence. La fonction \textsc{insert} doit allouer des identifiants tels que :
    \begin{equation}
      |s(I+1)| - |s(I)| < \mathcal{O}(I)
    \end{equation}
  \end{problem}
  
  \vspace{0.5cm}

  \begin{itemize}
  \item [$\rightarrow$] Sinon, il faut relocaliser les identifiants qui ont été
    générés pour conserver de bonnes performances
    \begin{itemize}
    \item [$\approx$] consensus répartis qui ne passe pas à l'échelle.
    \end{itemize}
  \end{itemize}

\end{frame}


\begin{frame}{Structure de séquences}{\LSEQ}
  
  Fonction d'allocation de chemins :
  \begin{enumerate}
  \item Une structure d'arbre dont l'arité maximale augmente avec la profondeur;
  \item Deux sous-fonctions d'allocation conçues pour gérer des comportements
    d'édition opposés;
  \item Une fonction assignant à chaque profondeur de l'arbre une sous-fonction
    d'allocation parmi celles disponibles.
  \end{enumerate}
  
\end{frame}


\begin{frame}{Structure de séquences}{Arbre exponentiel}

  \begin{center}
    \input{img/figexponentialtree.tex}
  \end{center}

\end{frame}


\begin{frame}{Structure de séquences}{Sous-fonctions d'allocations}
  
  \begin{minipage}{0.45\textwidth}
    \begin{center}
      \input{img/figsuballocationA.tex}
    \end{center}
  \end{minipage}
  \hfill
  \begin{minipage}{0.45\textwidth}
    \begin{center}
      \input{img/figsuballocationB.tex}
    \end{center}
  \end{minipage}

\end{frame}


\begin{frame}{Structure de séquences}{Choix de sous-fonction d'allocation}

\end{frame}

\begin{frame}{Structure de séquences}{Complexités}

  \begin{minipage}{0.32\textwidth}
    \begin{center}
      \input{img/figrandomlseqtree.tex}
    \end{center}
  \end{minipage}
  \begin{minipage}{0.32\textwidth}
    \begin{center}
      \input{img/figmonotoniclseqtree.tex}
    \end{center}
  \end{minipage}
  \begin{minipage}{0.32\textwidth}
    \begin{center}
      \input{img/figworstlseqtree.tex}
    \end{center}
  \end{minipage}

\end{frame}

\begin{frame}{Structure de séquences}{Complexité spatiale}
    \begin{textblock*}{\textwidth}(-1cm,-1.5cm) 
      \begin{table}[H]
        \input{img/tablelseqspace.tex}
      \end{table}
    \end{textblock*}
\end{frame}


\begin{frame}{Structure de séquences}{Complexité temporelle}

  \begin{center}
    \input{img/tablelseqtime.tex}
  \end{center}

\end{frame}

\begin{frame}{Structure de séquences}{Complexité temporelle du lookup}
  
  \begin{center}
    \input{img/tablelseqlookup.tex}
  \end{center}
  
\end{frame}


\begin{frame}{Structure de séquences}{Expérimentations}
  
\end{frame}

\begin{frame}{Structure de séquences}{Résultats attendus}
  
  \begin{itemize}
  \item Confirmation des résutlats de l'analyse en complexité
  \end{itemize}

\end{frame}



\begin{frame}{Structure de séquences}{Contribution de chaque composant}
  
  \hspace{-1cm}
  \begin{minipage}{0.45\textwidth}
    \includegraphics[width=1.25\textwidth]{img/replication/logoot.eps}
  \end{minipage}
  \hspace{1.5cm}
  \begin{minipage}{0.45\textwidth}
    \begin{tikzpicture}
      \node[visible on=<2-4>]
      {\includegraphics[width=1.25\textwidth]{img/replication/double.eps}};
    \end{tikzpicture}
  \end{minipage}
  
  \hspace{-1cm}
  \begin{minipage}{0.45\textwidth}
    \begin{tikzpicture}
      \node[visible on=<3-4>]
      {\includegraphics[width=1.25\textwidth]{img/replication/robin.eps}};
    \end{tikzpicture}
  \end{minipage}
  \hspace{1.5cm}
  \begin{minipage}{0.45\textwidth}
    \begin{tikzpicture}
      \node[visible on=<4-4>]
      {\includegraphics[width=1.25\textwidth]{img/replication/lseq.eps}};
    \end{tikzpicture}
  \end{minipage}

\end{frame}


\begin{frame}{Structure de séquences}{Identifiants sur traces réelles}

  \hspace{-1cm}
  \begin{minipage}{0.45\textwidth}
    \includegraphics[width=1.29\textwidth]{img/replication/poste.eps}
  \end{minipage}
  \hspace{1.2cm}
  \begin{minipage}{0.45\textwidth}
    \begin{tikzpicture}
      \node[visible on=<2>]
      {\includegraphics[width=1.29\textwidth]{img/replication/templatetalk.eps}};
    \end{tikzpicture}
  \end{minipage}


\end{frame}


\begin{frame}{Structure de séquences}{Évolution des performances}

  \begin{center}
    \includegraphics[width=\textwidth]{img/replication/time.eps}
  \end{center}

\end{frame}

\begin{frame}{Structure de séquences}{Effets de la concurrence}
  \vspace{-0.5cm}
  \begin{center}
    \includegraphics[angle=-90, width=\textwidth]{img/replication/latency.eps}
  \end{center}
\end{frame}

\begin{frame}{Structure de séquences}{Conclusion}

%  \begin{itemize}
%  \end{itemize}

\end{frame}